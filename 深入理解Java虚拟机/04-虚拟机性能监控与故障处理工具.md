# 第4章 虚拟机性能监控与故障处理工具

​    

## JDK 的命令行工具

### jps：虚拟机进程状况工具

显示正在运行的虚拟机进程、执行的主类（main() 所在的类）名称、这些进程的本地虚拟机 ID。

一般用该工具查出虚拟机 ID，然后进一步监控那个虚拟机进程。

### jstat：虚拟机统计信息监视工具

显示本地或者远程虚拟机进程中的类装载、内存、垃圾收集、JIT 编译等运行数据。

在没有 GUI 图形界面时，它是运行期定位性能问题的首选工具。

### jinfo：java 配置信息工具

实时查看、调整虚拟机参数。

### jmap：java 内存映像工具

生成堆转储快照（一般称为 heapdump 或 dump 文件）。

还可以查询 finalize 执行队列、Java 堆和永久代的详细信息，如空间使用率、当前使用的是哪种收集器等。

### jhat：虚拟机堆转储快照分析工具

与 jmap 搭配使用，来分析 jmap 生成的堆转储快照。

实际上，除非没有其他工具，一般不会用 jhat 来分析 dump 文件。

### jstack：java 堆栈跟踪工具

生成虚拟机当前时刻的线程快照（一般称为 threaddump 或者 javacore 文件），即虚拟机的每个线程正在执行的方法堆栈的集合。

目的是定位线程出现长时间停顿的原因，如线程间死锁、死循环、请求长时间等待等问题。可以查看那些线程在做什么，或者等待哪些资源。

JDK 1.5 中，java.lang.Thread 类提供了 getAllStackTraces() 方法，也可已完成 jstack 的大部分功能。

### hsdis：jit 生成反汇编

​    

## JDK 的可视化工具

### JConsole：Java 监视与管理控制台

### VisualVM：多合一故障处理工具

除了运行监控、故障处理外，还提供了如性能分析、动态日志跟踪（BTrace）等功能。

对应用程序的影响很小，可以直接在生产环境下使用。



