# 第2章 深入分析Java I/O的工作机制

​    

### Java 的 I/O 类库的基本架构

- 基于字节操作：InputStream、OutputStream
- 基于字符操作：Writer、Reader
- 基于磁盘操作：File
- 基于网络操作：Socket

I/O 操作最小的存储单元是字节。

#### 字节与字符的转化接口

读操作相关的类：Reader、InputStreamReader、StreamDecoder、Charset、InputStream。

InputStream 到 Reader 的过程需要指定编码字符集，否则默认采用操作系统默认的字符集。StreamDecoder 是完成从字节到字符解码的实现类。

​    

### 磁盘 I/O 工作机制

操作系统为了安全把内核程序运行使用的内存空间，和用户程序运行的内存空间进行了隔离。而应用程序要访问物理设备只能通过系统调用来工作，所以会导致内核空间地址和用户空间地址切换的问题（比如空间复制导致的效率问题（磁盘 I/O，数据从磁盘复制到内核空间，从内核空间再复制到用户空间））。

操作系统为了加速 I/O 访问，在内核空间里使用了缓存机制。这样用户要访问磁盘时，如果是同一段磁盘地址的空间数据，会从内核缓存中直接取出返回给用户程序。

#### 访问文件的方式

标准访问文件的方式