# 24. 优先考虑静态成员类

> 第三版

​    

**四种嵌套类：**静态成员类，非静态成员类，匿名类，局部类。

除了第一种以外，剩下的三种都被称为内部类（inner class）。

​    

### 静态成员类

可以访问所有宿主类的成员，甚至是那些被声明为私有类的成员。

静态成员类是其宿主类的静态成员，并遵循与其他静态成员相同的可访问性规则。 如果它被声明为 private，则只能在宿主类中访问，等等。

​    

### 非静态成员类

不能在没有宿主实例的情况下创建非静态成员类的实例。

**如果你声明了一个不需要访问宿主实例的成员类，最好弄成静态成员类**。否则每个实例都会有一个隐藏的外部引用给它的宿主实例，占用了空间和创建宿主实例的时间。更严重的是，并且会导致即使宿主类在满足垃圾回收的条件时却仍然驻留在内存中，**产生内存泄漏**。

​    

### 匿名类

当你想使用一个类的 protected 方法时，但是又不和这个类在同一个包下，你是没办法调用的。
这时候你可以声明一个匿名类继承该类，并定义一个方法，在这个方法内使用 super 调用你想调用的那个 protected 方法（其实也可以写个类继承这个类，就能调用父类的 protected 方法了，但是匿名类更简洁，因为你只想调用这个方法而已）。

常见用途是实现静态工厂方法。（方法中返回时：`return MyClass() {...};`）

​    

​    

### 局部类

四种嵌套类中使用最少。

一个局部类可以在任何可以声明局部变量的地方声明，并遵守相同的作用域规则。

像成员类一样，有名字，可以重复使用；

像匿名类一样，只有在非静态上下文中定义它们时，它们才会包含实例，并且它们不能包含静态成员；

像匿名类一样，应该保持简短，以免损害可读性。

